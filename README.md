# ocr-for-genshin-damage
利用paddleocr和opencv-python对原神视频进行处理，对队伍总伤害作处理。

use paddleocr and opencv-python to deal with the video of genshin impact to estimate the total damage of teams

发出来仅仅是为了抛砖引玉，目前仍处于很不完善的阶段，大部分伤害能够被识别，但由于伤害数字会存在十多帧，且玩家转视角时伤害也会跟随转动，存在大量重复的情况。少部分伤害由于快速被覆盖，导致能识别的帧很短甚至没有，识别伤害要么错误，要么识别不到。

请不要用于角色pvp。个人认为，角色pvp不利于社区环境，但玩家有权利对其购买的商品的好坏（角色强度）进行了解。既然米哈游选择了关闭黑榜、白榜，想让玩家搞不清角色相对强度，为爱买单，那么只好往绝对强度上走了。要让玩家不总是盯着角色强度，就请贵公司不要因为商业策略，就故意设计一些强度和其他同期角色差距过大的角色以及“没有任何弱点，加上一些故意恶心人的机制，非某个角色不行的怪物（比如说在存在高低差情况下，越飞越高的漂浮灵，以及后撤步会留下空气墙的兽境猎犬）”。

genshin_damage_estimate.py 选择1920×1080的pc端视频（其他平台的可以按自身情况对帧裁剪区域进行修改），输入视频中能造成的伤害类型，程序将自行将视频帧按各伤害的颜色进行区分识别，再对识别结果进行处理，最后给出队伍总伤和各伤害类型伤害（如需查看中间过程，请自行修改）。耗时受队伍中能造成的伤害类型以及视频帧数影响，大约是每6秒的视频就需要4分钟进行处理。如果paddleocr支持多线程或采用多服务器同时识别应该能够大大加快此速度。

video5diff.py 运用差帧法先对视频进行处理，再分类各属性伤害。虽然大大减少了重复情况，但识别率堪忧，故并没有再进行后续操作。

希望专业的又对此感兴趣的大佬能够对此代码进行改进，本人还有些不同于这两种的思路。1. 对怪物血条颜色进行识别，消失时再对最后一击伤害进行识别，由于怪物血量已知，就能得出队伍总伤。2.与各理论轴计算器进行结合，由于伤害大多能被识别到，对伤害进行推算后代入计算器，可得出实际轴伤害。3.通过同队多个视频，比如12层3间连打进行估计。

各队伍的xls文件为程序运行中产生的pre_process.xls文件，实测文件包含视频中各队伍的实际伤害统计和程序最终输出结果的对比。__请不要根据我的统计结果进行队伍pvp，源视频随机选取，练度不同，层数不同，也不一定是从队伍循环轴开始选取，视频时长也不同，没有任何代表性。__ 发出来只是为了给个程序效果的参考。
